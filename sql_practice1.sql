CREATE DATABASE ORG;
SHOW DATABASES;
USE ORG;

-- show tables;

CREATE TABLE Worker(
WORKER_ID INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
FIRST_NAME CHAR(25),
LAST_NAME CHAR(25),
SALARY INT(15),
JOINING_DATE DATETIME,
DEPARTMENT CHAR(25)
);

INSERT INTO Worker
(WORKER_ID,FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE,DEPARTMENT) VALUES
(001,'Monika','Arora',100000,'14-02-20 09.00.00','HR'),
(002,'Niharika','Verma',80000,'14-06-11 09.00.00','Admin'),
(003,'Vishal','Singhal',300000,'14-06-20 09.00.00','HR'),
(004,'Amitabh','Singh',500000,'14-06-20 09.00.00','Admin'),
(005,'Vivek','Bharti',500000,'14-06-11 09.00.00','Admin'),
(006,'Vipul','Diwan',200000,'14-06-11 09.00.00','Account'),
(007,'Satish','Kumar',75000,'14-06-20 09.00.00','Account'),
(008,'Geetika','Chahuan',90000,'14-06-11 09.00.00','Admin');

CREATE TABLE Bonus(
WORKER_REF_ID INT,
BONUS_AMOUNT INT(10),
BONUS_DATE DATETIME,
foreign key (WORKER_REF_ID) REFERENCES Worker(WORKER_ID) ON DELETE CASCADE
);

INSERT INTO Bonus
(WORKER_REF_ID,BONUS_AMOUNT,BONUS_DATE) VALUES
(001,5000,'2016-02-20'),
(002,3000,'2016-06-11'),
(003,4000,'2016-06-20'),
(001,4500,'2016-06-20'),
(002,3500,'2016-06-11');


CREATE TABLE Title(
WORKER_REF_ID INT,
WORKER_TITLE CHAR(25),
AFFECTED_FROM DATETIME,
foreign key (WORKER_REF_ID) REFERENCES Worker(WORKER_ID) ON DELETE CASCADE
);

INSERT INTO Title
(WORKER_REF_ID,WORKER_TITLE,AFFECTED_FROM) VALUES
(001,'Manager','2016-02-20 00:00:00'),
(002,'Executive','2016-06-11 00:00:00'),
(008,'Executive','2016-06-11 00:00:00'),
(005,'Manager','2016-06-11 00:00:00'),
(004,'Assistant Manager','2016-06-11 00:00:00'),
(007,'Executive','2016-06-11 00:00:00');

select * from Worker;
select * from Bonus;
select * from Title;



SELECT DEPARTMENT,AVG(SALARY)FROM WORKER GROUP BY DEPARTMENT;

SELECT DEPARTMENT,MIN(SALARY) FROM WORKER GROUP BY DEPARTMENT;

SELECT DEPARTMENT FROM WORKER GROUP BY DEPARTMENT HAVING COUNT(DEPARTMENT)>2;

-- Q1
SELECT FIRST_NAME AS WORKER_NAME FROM WORKER;

-- Q2
SELECT UPPER(FIRST_NAME) AS WORKER_NAME FROM WORKER;

-- Q3
SELECT DISTINCT DEPARTMENT FROM WORKER;

-- Q4
SELECT SUBSTRING(FIRST_NAME,1,3) FROM WORKER;

-- Q5
SELECT LOCATE('B',FIRST_NAME) FROM WORKER WHERE FIRST_NAME='AMITABH';

-- Q6
SELECT RTRIM(FIRST_NAME) FROM WORKER;

-- Q7
SELECT LTRIM(FIRST_NAME) FROM WORKER;

-- Q8
SELECT DISTINCT DEPARTMENT,LENGTH(DEPARTMENT) FROM WORKER;

-- Q9
SELECT REPLACE(FIRST_NAME,'a','A') FROM WORKER;

-- Q10
SELECT CONCAT(FIRST_NAME," ",LAST_NAME) AS COMPLETE_NAME FROM WORKER;

-- Q11
SELECT * FROM WORKER ORDER BY FIRST_NAME;

-- Q12
SELECT * FROM WORKER ORDER BY FIRST_NAME,DEPARTMENT DESC; 

-- Q13
SELECT * FROM WORKER WHERE FIRST_NAME IN ('SATISH','VIPUL');

-- Q14
SELECT * FROM WORKER WHERE FIRST_NAME NOT IN ('SATISH','VIPUL');

-- Q15
SELECT * FROM WORKER WHERE DEPARTMENT LIKE 'ADMIN%';

-- Q16
SELECT FIRST_NAME FROM WORKER WHERE FIRST_NAME LIKE '%A%';

-- Q17 
SELECT FIRST_NAME FROM WORKER WHERE FIRST_NAME LIKE '%A';

-- Q18
SELECT FIRST_NAME FROM WORKER WHERE FIRST_NAME LIKE '%H' AND LENGTH(FIRST_NAME)=6;

-- Q19
SELECT * FROM WORKER WHERE SALARY BETWEEN 100000 AND 500000;

-- Q20
SELECT * FROM WORKER WHERE YEAR(JOINING_DATE)='2014' AND MONTH(JOINING_DATE)='02';

-- Q21
SELECT DEPARTMENT,COUNT(*) FROM WORKER GROUP BY DEPARTMENT HAVING DEPARTMENT='ADMIN';

-- Q22
SELECT CONCAT(FIRST_NAME," ",LAST_NAME) FROM WORKER WHERE SALARY BETWEEN 50000 AND 100000;

-- Q23
SELECT DEPARTMENT,COUNT(DEPARTMENT) FROM WORKER GROUP BY DEPARTMENT ORDER BY COUNT(DEPARTMENT) DESC;

-- Q24
SELECT W.* , T.WORKER_TITLE FROM WORKER AS W INNER JOIN TITLE AS T ON W.WORKER_ID=T.WORKER_REF_ID WHERE T.WORKER_TITLE='MANAGER';

-- Q25
SELECT WORKER_TITLE,COUNT(*) FROM TITLE GROUP BY WORKER_TITLE HAVING COUNT(*)>1;

-- Q26
SELECT * FROM WORKER WHERE WORKER_ID%2=1;

-- Q27
SELECT * FROM WORKER WHERE WORKER_ID%2=0;

-- Q32
SELECT * FROM WORKER ORDER BY SALARY DESC LIMIT 5;

-- Q33
SELECT * FROM WORKER ORDER BY SALARY DESC LIMIT 4,1;

-- Q35
SELECT W1.* FROM WORKER AS W1,WORKER AS W2 WHERE W1.SALARY=W2.SALARY AND W1.WORKER_ID<>W2.WORKER_ID;

-- Q36
SELECT * FROM WORKER ORDER BY SALARY DESC LIMIT 2,1;
-- SECOND METHOD
SELECT MAX(SALARY) FROM WORKER WHERE SALARY != (SELECT MAX(SALARY) FROM WORKER);

-- Q37
SELECT * FROM WORKER 
UNION ALL
SELECT * FROM WORKER  ORDER BY WORKER_ID;

-- Q38
SELECT WORKER_ID FROM WORKER WHERE WORKER_ID NOT IN (SELECT WORKER_REF_ID FROM BONUS);

-- Q39
SELECT * FROM WORKER WHERE WORKER_ID<=
(SELECT COUNT(*)/2 FROM WORKER);

-- Q40
SELECT DEPARTMENT,COUNT(DEPARTMENT) FROM WORKER GROUP BY DEPARTMENT HAVING COUNT(DEPARTMENT)<4;

-- Q41
SELECT DEPARTMENT,COUNT(DEPARTMENT) FROM WORKER GROUP BY DEPARTMENT;

-- Q42
SELECT * FROM WORKER WHERE WORKER_ID=
(SELECT MAX(WORKER_ID) FROM WORKER);

-- Q43
SELECT * FROM WORKER WHERE WORKER_ID=
(SELECT MIN(WORKER_ID) FROM WORKER);

-- Q44
(SELECT * FROM WORKER ORDER BY WORKER_ID DESC LIMIT 5) ORDER BY WORKER_ID;

-- q49
SELECT DEPARTMENT,SUM(SALARY) FROM WORKER GROUP BY DEPARTMENT;

-- Q50
SELECT FIRST_NAME FROM WORKER WHERE SALARY=
(SELECT MAX(SALARY) FROM WORKER);




